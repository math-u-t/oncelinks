# 11. テスト

## 手動テストチェックリスト

### 認証フロー

- [ ] GitHub OAuthログイン
  - ログインボタンをクリック
  - GitHubで認証
  - ダッシュボードにリダイレクト

- [ ] Google OAuthログイン
  - ログインボタンをクリック
  - Googleで認証
  - ダッシュボードにリダイレクト

- [ ] メールログイン
  - メールアドレスとパスワード入力
  - ログイン成功
  - ダッシュボードに遷移

- [ ] 新規登録
  - メールアドレスとパスワード入力
  - 登録成功
  - 確認メールが送信される

- [ ] ログアウト
  - ログアウトボタンをクリック
  - ホームページにリダイレクト
  - 認証状態がクリア

### リンク管理

- [ ] リンク作成
  - タイトル入力（200文字以内）
  - HTMLコンテンツ入力
  - 作成ボタンをクリック
  - 成功トースト表示
  - URLが自動コピー

- [ ] リンク一覧表示
  - ダッシュボードに全リンク表示
  - アクティブ/使用済みのステータス表示
  - 作成日時表示

- [ ] リンクURLコピー
  - コピーボタンをクリック
  - クリップボードにコピー
  - トースト通知表示

- [ ] リンク削除
  - 削除ボタンをクリック
  - 確認ダイアログ表示
  - 削除成功
  - リストから消える

- [ ] 有効期限付きリンク
  - 有効期限を設定
  - リンク作成
  - 期限前にアクセス → 成功
  - 期限後にアクセス → エラー

### 一度リンク機能

- [ ] 初回アクセス
  - リンクURLにアクセス
  - コンテンツが表示される
  - 警告バナーが表示される
  - ステータスが「使用済み」になる

- [ ] 2回目アクセス
  - 同じURLに再度アクセス
  - 「既に使用されたか、存在しません」エラー
  - コンテンツは表示されない

- [ ] 同時アクセス
  - 2つのブラウザで同時にアクセス
  - 1つだけ成功
  - もう1つはエラー

- [ ] 無効なトークン
  - 存在しないトークンでアクセス
  - エラーメッセージ表示

### UI/UX

- [ ] ダークモード
  - トグルボタンをクリック
  - テーマが切り替わる
  - localStorageに保存される
  - リロード後も維持される

- [ ] レスポンシブデザイン
  - モバイル（375px）で表示
  - タブレット（768px）で表示
  - デスクトップ（1280px）で表示
  - すべてで正しく表示される

- [ ] トースト通知
  - 成功/エラー/警告/情報の4種類
  - 適切な色とアイコン
  - 3秒後に自動消滅
  - 手動で閉じられる

- [ ] ローディング状態
  - API呼び出し中にローディング表示
  - ボタンが無効化される
  - スピナーアイコンが表示される

## テストシナリオ

### シナリオ1: 基本フロー

1. ホームページにアクセス
2. GitHubでログイン
3. 「新規リンク作成」をクリック
4. タイトルとHTMLを入力
5. 「リンクを作成」をクリック
6. ダッシュボードに戻る
7. リンクカードが表示される
8. コピーボタンをクリック
9. 別のブラウザでURLにアクセス
10. コンテンツが表示される
11. 再度アクセス → エラー

### シナリオ2: 有効期限テスト

1. リンク作成画面で有効期限を設定（5分後）
2. リンクを作成
3. すぐにアクセス → 成功
4. 5分後にアクセス → エラー

### シナリオ3: エラーハンドリング

1. 空のタイトルで作成 → バリデーションエラー
2. ネットワークを切断して作成 → ネットワークエラー
3. 無効なトークンでアクセス → エラーページ

## 自動テスト（将来的）

### 単体テスト

```javascript
import { describe, it, expect } from 'vitest'
import { generateSecureToken } from '@/utils/tokenGenerator'

describe('tokenGenerator', () => {
  it('generates token of correct length', () => {
    const token = generateSecureToken(32)
    expect(token).toHaveLength(32)
  })
})
```

### E2Eテスト

Playwright or Cypressで実装を検討

```javascript
test('create and access once link', async ({ page }) => {
  await page.goto('/')
  await page.click('text=Sign in with GitHub')
  // ... OAuth flow ...
  await page.click('text=新規リンク作成')
  // ... test continues ...
})
```
